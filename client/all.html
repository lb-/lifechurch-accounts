<head>
  <title>Accounts</title>
</head>

<body>
  <div class="container">
    {{>nav}}
    <section id="cards">
      {{>cards}}
    </section>
    <section id="cardUsage">
      {{>cardUsage usage=usage}}
    </section>
  </div>
</body>

<template name="insertCardUsagesForm">
  {{> quickForm collection="CardUsages" id="insertCardUsagesForm" type="insert"}}
</template>

<template name="cards">
  <div class="row">
    {{#each cards}}
      {{>card}}
    {{/each}}
  </div>
</template>

<template name="card">
  <div class="col-sm-6 col-md-4">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h2 class="panel-title">{{designation}} <small>Petty Cash Card</small></h2>
      </div>
      <div class="panel-body">
        {{#if available}}
          <button class="btn btn-success btn-block" {{enabled user}}>Sign Out</button>
        {{else}}
          <button class="btn btn-default btn-block">Sign In</button>
        {{/if}}
      </div>
      <div class="panel-footer">
        {{#if available}}
          {{previousUsageDescription}}
        {{else}}
          {{currentUsageDescription}}
        {{/if}}
      </div>
    </div>
  </div>
</template>

<template name="cardUsage">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h2 class="panel-title"><span class="label label-default">Sign In</span> {{usage.designation}} <small>Petty Cash Card</small></h2>
    </div>
    <div class="panel-body">
      {{#if usage.signInMode}}
      <h3>Receipts <small>3 Total</small></h3>
      <ul class="list-group">
        {{#each usage.receipts}}
        <li class="list-group-item">
          <h4 class="list-group-item-heading">{{ordinalNumber i}} Receipt</h4>
          <p class="list-group-item-text">
            {{>receiptForm}}
          </p>
        </li>
        {{/each}}
        <li class="list-group-item">
          <h4 class="list-group-item-heading">Add Receipt</h4>
          <p class="list-group-item-text">
            <button class="btn btn-default">Add Receipt</button>
          </p>
        </li>
      </ul>
      {{else}}
      <h3>Purpose</h3>
        {{#autoForm schema=Schemas.cardUsage id="someID" type="method" meteormethod="test"}}
          {{> afQuickField name="purpose"}}
        {{/autoForm}}
      {{/if}}
      <h3>Notes</h3>
      {{#autoForm schema=Schemas.cardUsage id="someID" type="method" meteormethod="test"}}
        {{#if usage.signInMode}}
          {{> afQuickField name="signedInComments"}}
        {{else}}
          {{> afQuickField name="signedOutComments"}}
        {{/if}}
      {{/autoForm}}
    </div>
    <div class="panel-footer">
      $30.00 total (2 receipts)
    </div>
  </div>
</template>

<template name="nav">
  <nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-4">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">Petty Cash Card</a>
      </div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-4">
        {{> loginButtons}}
        {{#if user}}
        <p class="navbar-text">Signed in as {{user.profile.name}}</p>
        {{/if}}
      </div>
    </div>
  </nav>
</template>
